<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Opera√ß√£o Caixa Preta</title>
  <style>
    :root{
      --accent:#21d07a; --accent-2:#00a86b;
      --text:#e7f6ef; --muted:#a9c7b9; --ok:#5be37b; --err:#ff6b6b;
      --thumb-ring: rgba(255,255,255,.18);
      --bg:#0b1d1a;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;
      color:var(--text); background:var(--bg);
    }

    header{ padding:16px 18px; display:flex; align-items:center; gap:10px }
    header .badge{ background:rgba(0,0,0,.45); padding:6px 10px; border-radius:999px; font-size:.85rem; color:var(--muted) }
    header h1{ margin:0; font-size:1.1rem; text-shadow:0 3px 12px rgba(0,0,0,.5) }

    .thumbs{ display:flex; justify-content:center; gap:18px; padding:8px 14px 0; flex-wrap:wrap }
    .thumb{ position:relative; width:56px; height:66px; display:grid; place-items:center; border-radius:12px; background:transparent; border:1px dashed transparent; transition:transform .15s ease, border-color .15s ease, background-color .15s ease; filter: drop-shadow(0 4px 10px rgba(0,0,0,.28)) }
    .thumb svg{ width:42px; height:52px }
    .thumb.active{ transform:scale(1.08); border-color:var(--thumb-ring); background:rgba(0,0,0,.15) }
    .num{ position:absolute; top:-6px; right:-6px; min-width:18px; height:18px; padding:0 4px; display:grid; place-items:center; border-radius:999px; background:linear-gradient(180deg,var(--accent),var(--accent-2)); color:#062315; font-weight:800; font-size:.7rem; border:1px solid rgba(0,0,0,.25); box-shadow:0 2px 6px rgba(0,0,0,.25) }

    .stage{ display:grid; place-items:center; min-height:58dvh; padding:16px 12px }
    .card{ background:transparent; border:none; box-shadow:none; display:flex; flex-direction:column; align-items:center; gap:14px; text-align:center; padding:16px; animation: pop .22s ease-out }
    @keyframes pop{ from{ transform:translateY(-6px); opacity:0 } to{ transform:translateY(0); opacity:1 } }
    .card h2, .card p, .status{ text-shadow:0 0 6px rgba(0,0,0,.8) }

    #bigLock svg{ width:150px; height:185px; filter: drop-shadow(0 8px 22px rgba(0,0,0,.35)); animation:pulse 1s ease-in-out infinite }
    @keyframes pulse{ 0%,100%{ transform:scale(1); filter:drop-shadow(0 0 0 rgba(114,241,179,.0)) } 50%{ transform:scale(1.06); filter:drop-shadow(0 0 14px rgba(114,241,179,.5)) } }

    .row{ display:flex; gap:10px; align-items:center; width:min(520px,90vw) }
    input[type="text"]{ flex:1; padding:12px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.25); background:rgba(0,0,0,.35); color:var(--text); font-size:1rem; outline:none }
    button{ padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.15); background:linear-gradient(180deg,var(--accent),var(--accent-2)); color:#062315; font-weight:700; cursor:pointer }
    .status{ min-height:22px; font-size:.95rem }
    .ok{ color:var(--ok) } .err{ color:var(--err) }

    .dock{ display:flex; justify-content:center; gap:14px; padding:10px 10px; margin:8px 0 0; background:rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.12); border-radius:12px; box-shadow:0 8px 18px rgba(0,0,0,.15); width:fit-content; margin-inline:auto }
    .dock .slot{ width:42px; height:52px; display:grid; place-items:center }
    .dock svg{ width:32px; height:40px; filter: drop-shadow(0 4px 10px rgba(0,0,0,.28)) }

    .tips-footer{ display:flex; justify-content:space-between; align-items:center; gap:12px; padding:16px 22px; margin-top:16px; flex-wrap:wrap }
    .help{ background:rgba(0,0,0,.6); color:var(--muted); padding:8px 12px; border-radius:12px; font-size:.9rem }
    .reset{ background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,.18); padding:10px 14px; border-radius:12px }

    .modal{ position:fixed; inset:0; display:none; place-items:center; z-index:10 }
    .modal.show{ display:grid }
    .modal .box{ background:#061914cc; color:var(--text); padding:28px; border-radius:16px; text-align:center; max-width:90% }
  </style>
</head>
<body>
  <header>
    <span class="badge">Jogo Sequencial</span>
    <h1>Opera√ß√£o Caixa Preta</h1>
  </header>

  <div class="thumbs" id="thumbs" aria-label="Pr√≥ximos cadeados"></div>
  <main class="stage" id="stage"></main>
  <div class="dock" id="dock" aria-label="Cadeados abertos"></div>

  <div class="tips-footer">
    <div class="help">Dica: as senhas n√£o diferenciam mai√∫sculas/min√∫sculas.</div>
    <button class="reset" id="btnReset" title="Reiniciar">Reiniciar</button>
  </div>

  <div class="modal" id="congrats">
    <div class="box">
      <h3>Parab√©ns, voc√™s conclu√≠ram o desafio üéâ</h3>
      <button id="closeModal">Fechar</button>
    </div>
  </div>

  <script>
    // 5 cadeados com as senhas que voc√™ passou
    const LOCKS = [
      { id: 1, titulo: 'Cadeado 1', senha: '125'     },
      { id: 2, titulo: 'Cadeado 2', senha: '144'     },
      { id: 3, titulo: 'Cadeado 3', senha: '12'      },
      { id: 4, titulo: 'Cadeado 4', senha: '100'     },
      { id: 5, titulo: 'Cadeado 5', senha: '9075210' },
    ];

    // chave nova p/ n√£o conflitar
    const LS_KEY = 'ocp-v5-sem-fundo-5';
    let state = JSON.parse(localStorage.getItem(LS_KEY) || '{"idx":0}');
    const save = () => localStorage.setItem(LS_KEY, JSON.stringify(state));

    // Normaliza√ß√£o compat√≠vel com GitHub Pages
    function normalize(v){
      return (v||'').toString().trim().toUpperCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
    }

    const thumbs = document.getElementById('thumbs');
    const stage  = document.getElementById('stage');
    const dock = document.getElementById('dock');
    const modal = document.getElementById('congrats');

    document.getElementById('btnReset').onclick = () => { state={idx:0}; save(); renderAll(); };
    document.getElementById('closeModal').onclick = () => modal.classList.remove('show');

    function lockSVG({open=false}={}){
      const gradTop = open ? '#bff5d7' : '#cfeee1';
      const gradBot = open ? '#31c788' : '#35b986';
      const ringGrad = `
        <linearGradient id="ringGrad" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#ffffff"/><stop offset="100%" stop-color="#dfeee8"/>
        </linearGradient>`;
      const bodyGrad = `
        <linearGradient id="bodyGrad" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="${gradTop}"/><stop offset="100%" stop-color="${gradBot}"/>
        </linearGradient>`;
      return `
      <svg viewBox="0 0 64 80" role="img" aria-label="Cadeado" xmlns="http://www.w3.org/2000/svg">
        <defs>${ringGrad}${bodyGrad}</defs>
        ${open
          ? `<path d="M16 26 v-8 a16 16 0 0 1 32 0" fill="none" stroke="url(#ringGrad)" stroke-width="4" stroke-linecap="round"/>`
          : `<path d="M16 28 v-8 a16 16 0 0 1 32 0 v8" fill="none" stroke="url(#ringGrad)" stroke-width="4" stroke-linecap="round"/>`}
        <rect x="8" y="28" width="48" height="42" rx="10" fill="url(#bodyGrad)" stroke="#0b3b2d" stroke-width="2" />
        <circle cx="32" cy="46" r="4" fill="#0b3b2d"/>
      </svg>`;
    }

    function renderTopbar(idx){
      thumbs.innerHTML = '';
      LOCKS.forEach((l, i) => {
        if (i <= idx) return;
        const active = i === idx + 1;
        const t = document.createElement('div');
        t.className = 'thumb' + (active ? ' active' : '');
        t.id = 'thumb-' + i;
        t.innerHTML = lockSVG({open:false});
        const badge = document.createElement('div');
        badge.className = 'num';
        badge.textContent = (i+1);
        t.appendChild(badge);
        thumbs.appendChild(t);
      });
    }

    function ensureDockSlots(n){
      dock.innerHTML = '';
      for(let i=0;i<n;i++){
        const s = document.createElement('div');
        s.className = 'slot';
        s.id = 'dock-slot-' + i;
        dock.appendChild(s);
      }
    }

    function renderStage(){
      stage.innerHTML = '';
      if (state.idx >= LOCKS.length) { modal.classList.add('show'); return; }
      else { modal.classList.remove('show'); }

      const current = LOCKS[state.idx];
      const card = document.createElement('section');
      card.className = 'card';
      card.innerHTML = `
        <h2>${current.titulo}</h2>
        <div class="lock-illustration" id="bigLock">${lockSVG({open:false})}</div>
        <p class="muted" aria-live="polite">Ativo: digite a senha para abrir.</p>
        <div class="row">
          <input id="pass" type="text" autocomplete="off" placeholder="Senha do ${state.idx+1}¬∫" aria-label="Senha do cadeado atual">
          <button id="btnOpen">Abrir</button>
        </div>
        <div class="status" id="status"></div>`;
      stage.appendChild(card);

      const input = card.querySelector('#pass');
      const btn = card.querySelector('#btnOpen');
      const status = card.querySelector('#status');

      function animateFlyToDock(){
        const big = document.getElementById('bigLock')?.querySelector('svg');
        const dest = document.getElementById('dock-slot-' + state.idx);
        if(!big || !dest){ state.idx += 1; save(); renderAll(); return; }
        const br = big.getBoundingClientRect();
        const dr = dest.getBoundingClientRect();
        const ghost = document.createElement('div');
        ghost.style.position = 'fixed'; ghost.style.left = '0'; ghost.style.top = '0'; ghost.style.zIndex = '8';
        ghost.innerHTML = lockSVG({open:true});
        document.body.appendChild(ghost);
        const gsvg = ghost.querySelector('svg');
        ghost.style.transform = `translate(${br.left}px, ${br.top}px)`;
        gsvg.style.width = br.width + 'px'; gsvg.style.height = br.height + 'px';
        const scaleX = dr.width / br.width; const scaleY = dr.height / br.height;
        const dx = dr.left - br.left; const dy = dr.top  - br.top;
        ghost.animate([
          { transform:`translate(${br.left}px, ${br.top}px) scale(1)`, opacity:1 },
          { transform:`translate(${br.left+dx}px, ${br.top+dy}px) scale(${scaleX}, ${scaleY})`, opacity:1 }
        ], { duration: 360, easing:'ease-in-out' }).onfinish = () => {
          ghost.remove(); dest.innerHTML = lockSVG({open:true}); state.idx += 1; save(); renderAll();
        };
      }

      function tryOpen(){
        const val = normalize(input.value);
        if (!val) { status.innerHTML = '<span class="err">Digite a senha.</span>'; return; }
        if (val === normalize(current.senha)) {
          status.innerHTML = '<span class="ok">Cadeado aberto!</span>';
          document.getElementById('bigLock').innerHTML = lockSVG({open:true});
          animateFlyToDock();
        } else {
          status.innerHTML = '<span class="err">Senha incorreta.</span>';
        }
      }

      btn.addEventListener('click', tryOpen);
      input.addEventListener('keydown', e => { if (e.key === 'Enter') tryOpen(); });
      setTimeout(()=>input.focus(), 0);
    }

    function renderAll(){
      ensureDockSlots(LOCKS.length);
      for(let i=0;i<state.idx;i++){
        const s = document.getElementById('dock-slot-'+i);
        if(s && !s.innerHTML) s.innerHTML = lockSVG({open:true});
      }
      renderTopbar(state.idx);
      renderStage();
    }

    window.addEventListener('load', renderAll);
    renderAll();
  </script>
</body>
</html>
